
import 'hash'

rule Identify_Malware
		{
			meta: 
				description = "Detects Malware - in the system already based on Hashes"
				authour = "Vasanth"
				reference == "Malware repository"
			/**
			
			string:
			$hash1 = hash.md5(0,filesize) =	'd3ee54312111205f6f45a70ec5708027' and
				hash.sha1(0,filesize)=	'5db38487a3c1ecdba8e3ce0ba2ecf125bd3e0a8d' and
				hash.sha256(0,filesize)= '835e596d96a8769a90aaea21454f1527ed1d1d9cccddfb6542c9cc270ce4887f'
			
			$hash2 =hash.md5(0,filesize) = 	'bbdf48fcbfbdf66d7edd289910168dfe' and
				hash.sha1(,filesize)=  '1b47417522b6ee0c5c3e7a4bd9aeb02b53a82f25' and 
				hash.sha256(0,filesize)= 'ce3a646d93937a44da7751edadcbab3c9f3fa83e3d6300e3f984601772d8f8e5'		
			$hash3  = hash.md5(0,filesize) =	'b4da1560e38fb75c0327c89eee23c95d' and
				hash.sha1(0,filesize)=	'407ac0dbc16724e7a74f73573e1b0f46807fd89c' and
				hash.sha256(0,filesize) = '58557a66753321749c3562bf306b93ff0af19f645db89cf6c0ac70aacef131b1'
				
			$hash4= hash.md5(0,filesize) =  '5703da3070a8998b2955e4907df2bf4d' and
				hash.sha1(0,filesize) = '940d20c3b2179078e471a60c967baa69949877fd' and
				hash.sha256(0,filesize)= 'bd49f04c15e595f7f4d9a10326918c977fe352c822dde7380c2d7047835061f4' 
			$hash5 = hash.md5(0,filesize) = 	'624ca00854511bad165c4bc543aaba1a' and
					 hash.sha1(0,filesize)= 'e03243eff48064a04796bfcb25006125cfcf890e' and
					 hash.sha256(0,filesize)= '1fe874d558ddd6fa5d97c8a6f89aa13ccf6895e125aebe51aea5fa08cd241dbe'
			
			$ hash6= hash.md5(0,filesize) = 	'07549f96e9917cc76ca6f57a3ecfcc86' and
					 hash.sha1(0,filesize) =	 'cdf69bcac6ebcb8162f39e4f58f781494227cce7' and 
					 hash.sha256(,filesize)= '5163e0e3e89ae87411e087ae742a34f3982537fdcb22ca507543b1c39391467b'
			**/
			condition:
				uint16(0) = 0x5A4D and 
				filesize < 500MB and  
				hash.md5(0,filesize) =	'd3ee54312111205f6f45a70ec5708027' and
				hash.sha1(0,filesize)=	'5db38487a3c1ecdba8e3ce0ba2ecf125bd3e0a8d' and
				hash.sha256(0,filesize)= '835e596d96a8769a90aaea21454f1527ed1d1d9cccddfb6542c9cc270ce4887f' or
				hash.md5(0,filesize) = 	'bbdf48fcbfbdf66d7edd289910168dfe' and
				hash.sha1(,filesize)=  '1b47417522b6ee0c5c3e7a4bd9aeb02b53a82f25' and 
				hash.sha256(0,filesize)= 'ce3a646d93937a44da7751edadcbab3c9f3fa83e3d6300e3f984601772d8f8e5' or
				hash.md5(0,filesize) =	'b4da1560e38fb75c0327c89eee23c95d' and
				hash.sha1(0,filesize)=	'407ac0dbc16724e7a74f73573e1b0f46807fd89c' and
				hash.sha256(0,filesize) = '58557a66753321749c3562bf306b93ff0af19f645db89cf6c0ac70aacef131b1' or
				hash.md5(0,filesize) =  '5703da3070a8998b2955e4907df2bf4d' and
				hash.sha1(0,filesize) = '940d20c3b2179078e471a60c967baa69949877fd' and
				hash.sha256(0,filesize)= 'bd49f04c15e595f7f4d9a10326918c977fe352c822dde7380c2d7047835061f4' or 
				hash.md5(0,filesize) = 	'624ca00854511bad165c4bc543aaba1a' and
				hash.sha1(0,filesize)= 'e03243eff48064a04796bfcb25006125cfcf890e' and
				hash.sha256(0,filesize)= '1fe874d558ddd6fa5d97c8a6f89aa13ccf6895e125aebe51aea5fa08cd241dbe'
				hash.md5(0,filesize) = 	'07549f96e9917cc76ca6f57a3ecfcc86' and
				hash.sha1(0,filesize) =	'cdf69bcac6ebcb8162f39e4f58f781494227cce7' and 
				hash.sha256(,filesize)= '5163e0e3e89ae87411e087ae742a34f3982537fdcb22ca507543b1c39391467b'
				
					
		
		}

